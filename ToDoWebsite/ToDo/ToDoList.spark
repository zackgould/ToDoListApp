<!DOCTYPE html>
<viewdata model="ToDoWebsite.ToDo.ToDoListViewModel" />
<html>
  <head>
    <title>My Applications</title>
    <style type="text/css">
      form { display: inline }
    </style>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/themes/smoothness/jquery-ui.css" />
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/jquery-ui.min.js"></script>
    <script type="text/javascript">

      $(document).ready(function(){

      $("input[class=left]").hide();
      $("input[class=right]").hide();
      $("input[class=save]").hide();



      $("span").click(function(){
      $(this).hide();
      $(this).parent().children(".remove").hide();
      $(this).parent().next().find(".right").show();
      $(this).parent().next().find(".save").show();


      $("span").click(function(){
      $("span").show();
      $("span").parent().children(".remove").show();
      $("span").parent().next().find(".right").hide();
      $("span").parent().next().find(".save").hide();

      $(this).hide();
      $(this).parent().children(".remove").hide();
      $(this).parent().next().find(".right").show();
      $(this).parent().next().find(".save").show();

      });
      });


      $(function() {
      $( "#sortable" ).sortable({
      update: function() { send(); }
      });
      $( "#sortable" ).disableSelection();
      });

      function send() {

      var arrayToDo = [];
      $("#sortable span").each(function() { arrayToDo.push($(this).text()) });

      $.ajax({
      url: 'SortList/?Username=${Model.Username}',
      type: 'post',
      contentType: "application/json",
      dataType: "json",
      data: JSON.stringify({ arrayToDo: arrayToDo })

      });
      }
      $('div#parent div:last').each(function() {
      var p = $(this).parent();
      $(this).height(p.height() - ($(this).offset().top - p.offset().top));
      });

      $("div").click(function(){
      $("span").show();
      $("input[class=right]").hide();
      $("input[class=save]").hide();
      $("input[class=remove]").show();


      });

      });
    </script>
  </head>
  <body>
    <h1>Welcome To The To Do List Application!</h1>

    <form method="post" action="to?Username=${Model.Username}">
      <input type="text" name="AddItem" placeholder="Enter Item" />
      <input type="submit" value="Submit"  />
    </form>
    <h2>Your To Do List</h2>
    <ol id="sortable">
      <li each="var item in Model.ToDoList">
        <form method="post" action="removed?Username=${Model.Username}">
          <span>${item}</span>
          <input class="left" type="text" name="DeleteItem" value="${item}" />
          <input class="remove" type="submit" value="Remove" />
        </form>
        <form class="two" method="post" action="edited?Username=${Model.Username}">
          <input class="left" type="text" name="CompareItem" value="${item}" />
          <input class="right" type="text" name="ModItem" value="${item}" />
          <input class="save" type="submit" value="Save" />
        </form>
      </li>
    </ol>
    <div style="height:750px">
      <div></div>
    </div>
  </body>
</html>
